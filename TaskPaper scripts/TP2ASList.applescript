property eProj : 1property eTask : 2property eNote : 3-- PLACE THE TASKPAPER FRONT DOCUMENT IN THE CLIPBOARD -- AS A SIMPLE TAB-INDENTED OUTLINEtell application "TaskPaper"	set lstDocs to documents	if lstDocs ≠ {} then				-- READ THE DOCUMENT TO A NESTED LIST		set lstNodes to my TP2List(item 1 of lstDocs)				-- AND WRITE OUT A TAB-INDENTED VERSION OF THAT LIST		set strTabbed to ("TaskPaper " & (current date) as string) & ¬			linefeed & my TabIndented(lstNodes, 1)		set the clipboard to strTabbed	end ifend tell-- NESTED LIST TO TAB-INDENTED OUTLINEon TabIndented(lstNodes, lngTabs)	set strTabs to ""	repeat with i from 1 to lngTabs		set strTabs to strTabs & tab	end repeat		set str to ""	repeat with i from 1 to length of lstNodes		set {strName, eType, lstChiln} to item i of lstNodes		set str to str & strTabs & strName & linefeed		if lstChiln ≠ {} then set str to str & TabIndented(lstChiln, lngTabs + 1)	end repeat	return strend TabIndented-- TASKPAPER TO LISTon TP2List(oDoc)	tell application "TaskPaper"		tell oDoc to return my GetTree(its projects)	end tellend TP2Liston GetTree(lstNodes)	tell application "TaskPaper"		repeat with i from 1 to length of lstNodes			tell item i of lstNodes				set lstChiln to entries				if lstChiln ≠ {} then					set lstSubTree to my GetTree(lstChiln)				else					set lstSubTree to {}				end if				set item i of lstNodes to {its name, my Type2Int(its entry type), lstSubTree}			end tell		end repeat		return lstNodes	end tellend GetTreeon Type2Int(eType)	using terms from application "TaskPaper"		if eType is project type then			return eProj		else if eType is task type then			return eTask		else if eType is note type then			return eNote		end if	end using terms fromend Type2Int